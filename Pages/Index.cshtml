@page
@model IndexModel

<h1>Marine Geospatial Viewer</h1>

<form method="post">
    <label for="latitude">Latitude:</label>
    <input type="text" id="latitude" name="Latitude" />
    
    <label for="longitude">Longitude:</label>
    <input type="text" id="longitude" name="Longitude" />
    
    <button type="submit">Add/View Data</button>
</form>

<!-- Data Display Section -->
<div>
    @Model.Message
</div>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />

<!-- Map Container -->
<div id="map" style="width: 100%; height: 400px;"></div>

<!-- Leaflet JavaScript -->
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

<script>
    var map = L.map('map').setView([51.505, -0.09], 13); // Default to London, zoom level 13

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    var coordinates = @Json.Serialize(Model.Coordinates);

    coordinates.forEach(coord => {
        if (coord.latitude && coord.longitude) {
            L.marker([coord.latitude, coord.longitude]).addTo(map);
        } else {
            console.error("Invalid coordinate:", coord);
        }
    });
</script>
